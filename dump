SELECT
    I.KEYRISKINDICATOR_ID
FROM
    RT_KEYRISKINDICATOR AS I
LEFT JOIN BO_ENUMVALS AS E_TYPE00 ON E_TYPE00.ENUMVALID = I.TYPE00
LEFT JOIN BO_ENUMVALS AS E_STATUS ON E_STATUS.ENUMVALID = I.STATUS
LEFT JOIN BO_ENUMVALS AS E_FREQUENCY00 ON E_FREQUENCY00.ENUMVALID = I.FREQUENCY00
LEFT JOIN BO_ENUMVALS AS E_UNIT_OF_MEASURE00 ON E_UNIT_OF_MEASURE00.ENUMVALID = I.UNIT_OF_MEASURE00
LEFT JOIN BO_ENUMVALS AS E_DIRECTION_INFORMATION00 ON E_DIRECTION_INFORMATION00.ENUMVALID = I.DIRECTION_INFORMATION00
LEFT JOIN BO_ENUMVALS AS E_ORGANISATION ON E_ORGANISATION.ENUMVALID = I.ORGANISATION
LEFT JOIN BO_ENUMVALS AS E_CATL1 ON E_CATL1.ENUMVALID = I.CATL1
LEFT JOIN BO_ENUMVALS AS E_CATL2 ON E_CATL2.ENUMVALID = I.CATL2
LEFT JOIN BO_ENUMVALS AS E_BREACH_STATUS ON E_BREACH_STATUS.ENUMVALID = I.BREACH_STATUS
LEFT JOIN BO_ENUMVALS AS E_INDICATOR_TREND ON E_INDICATOR_TREND.ENUMVALID = I.INDICATOR_TREND
LEFT JOIN BO_ENUMVALS AS E_DELMARK ON E_DELMARK.ENUMVALID = I.DELMARK
LEFT JOIN ACTORINFO AS U_CHECKED_IN_BY ON U_CHECKED_IN_BY.ACTORID = I.CHECKED_IN_BY
LEFT JOIN ACTORINFO AS U_CREATOR ON U_CREATOR.ACTORID = I.CREATOR
LEFT JOIN BO_KEYRISKINDICATORVALUE AS VL ON VL.KEYRISKINDICATORVAL_ID = (
    SELECT
        RE1.KEYRISKINDICATORVAL_ID
    FROM
        RT__KEYRISKINDICATOR_KEYRISKIN AS REL1
    JOIN BO_KEYRISKINDICATORVALUE AS RE1 ON REL1.KEYRISKINDICATORVAL_ID = RE1.KEYRISKINDICATORVAL_ID
        AND REL1.REPORTING_PERIOD_ID = RE1.REPORTING_PERIOD_ID
        AND RE1.DELMARK = 'No'
    WHERE
        REL1.KEYRISKINDICATOR_ID = I.KEYRISKINDICATOR_ID
    ORDER BY
        RE1.VALUE_DATE DESC,
        RE1.KEYRISKINDICATORVAL_ID
    LIMIT 1
)
LEFT JOIN BO_KEYRISKINDICATORVALUE AS VP1 ON VP1.KEYRISKINDICATORVAL_ID = (
    SELECT
        RE1.KEYRISKINDICATORVAL_ID
    FROM
        RT__KEYRISKINDICATOR_KEYRISKIN AS REL1
    JOIN BO_KEYRISKINDICATORVALUE AS RE1 ON REL1.KEYRISKINDICATORVAL_ID = RE1.KEYRISKINDICATORVAL_ID
        AND REL1.REPORTING_PERIOD_ID = RE1.REPORTING_PERIOD_ID
        AND RE1.DELMARK = 'No'
    WHERE
        REL1.KEYRISKINDICATOR_ID = I.KEYRISKINDICATOR_ID
    ORDER BY
        RE1.VALUE_DATE DESC,
        RE1.KEYRISKINDICATORVAL_ID
    LIMIT 1 OFFSET 1
)
LEFT JOIN BO_KEYRISKINDICATORVALUE AS VP2 ON VP2.KEYRISKINDICATORVAL_ID = (
    SELECT
        RE1.KEYRISKINDICATORVAL_ID
    FROM
        RT__KEYRISKINDICATOR_KEYRISKIN AS REL1
    JOIN BO_KEYRISKINDICATORVALUE AS RE1 ON REL1.KEYRISKINDICATORVAL_ID = RE1.KEYRISKINDICATORVAL_ID
        AND REL1.REPORTING_PERIOD_ID = RE1.REPORTING_PERIOD_ID
        AND RE1.DELMARK = 'No'
    WHERE
        REL1.KEYRISKINDICATOR_ID = I.KEYRISKINDICATOR_ID
    ORDER BY
        RE1.VALUE_DATE DESC,
        RE1.KEYRISKINDICATORVAL_ID
    LIMIT 1 OFFSET 2
)
WHERE
    I.REPORTING_PERIOD_ID = -1;
